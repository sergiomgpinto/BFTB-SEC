//
// Protocol buffers definition for bftb server
//
syntax = "proto3";
package pt.tecnico.bftb.grpc;

/*----------------------------- Requests & Responses ------------------------------*/

message OpenAccountRequest{
  bytes key = 1;
}

message OpenAccountResponse{
  string response = 1;
  string publicKey = 2;
}

message SendAmountRequest{
  string senderKey = 1;
  string receiverKey = 2;
  int32 amount = 3;
}

message SendAmountResponse{
  string response = 1;
}

message CheckAccountRequest{
  string key = 1;
}

message CheckAccountResponse{
  int32 balance = 1;
  repeated string pending= 2;
}

message AuditRequest{
  string key = 1;
}

message AuditResponse{
  repeated string set = 1;
}

message ReceiveAmountRequest{
  string receiverKey = 1;
  string senderKey = 2;
  int32 transactionId = 3;
  bool answer = 4;//true for accept and false for reject
}

message ReceiveAmountResponse{
  string result = 1;
}

message SearchKeysRequest{}

message SearchKeysResponse{
  repeated string result = 1;
}

message EncryptedMessage{
  string encryptedmessage = 1;
}

/*----------------------------- Requests & Responses ------------------------------*/



/*------------------------------------ service ------------------------------------*/

service BFTB{
  rpc openAccount(EncryptedMessage) returns (EncryptedMessage);
  rpc sendAmount(SendAmountRequest) returns (SendAmountResponse);
  rpc checkAccount(CheckAccountRequest) returns (CheckAccountResponse);
  rpc audit(AuditRequest) returns (AuditResponse);
  rpc receiveAmount(ReceiveAmountRequest) returns (ReceiveAmountResponse);
  rpc searchKeys(SearchKeysRequest) returns (SearchKeysResponse);
}

/*------------------------------------ service ------------------------------------*/





